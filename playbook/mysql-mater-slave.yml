---
  - import_playbook: variable-check.yml
    vars:
      playbook: dev.yml

  - name: Test Connection and Determine Remote User
    hosts: mysql_slave
    gather_facts: false
    roles:
      - { role: connection, tags: [connection, always] }

  - hosts: mysql_slave
    become: yes
    gather_facts: false
    pre_tasks: 
      - name: Install python2 for Ansible
        raw: bash -c "test -e /usr/bin/python || (apt -qqy update && apt install -qqy python-minimal)"
        register: output
        changed_when: output.stdout != ""
      - name: Gathering Facts
        setup:
    roles:
      - { role: database/mysql }

# Inventory Exp.
# mysql_master: 
#   hosts:
#     142.93.214.247:
#   vars:
#     ansible_ssh_user: root
#     server_name: 'mysql'
#     mysql_bind_address: '{{ mysql_replication_master }}'
#     mysql_server_id: 1
#     mysql_replication_role: 'master'
#     mysql_replication_user: { name: slave_user, host: '%', password: amitkverma }


# mysql_slave: 
#   hosts:
#     139.59.83.205:
#       server_name: 'slave1'
#       mysql_server_id: 11
#     142.93.209.30:
#       server_name: 'slave1'
#       mysql_server_id: 11
#   vars:
#     ansible_ssh_user: root
#     server_name: 'mysql'
#     mysql_replication_role: 'slave'
#     mysql_replication_user: { name: slave_user, host: '{{ mysql_replication_master }}', password: amitkverma }
