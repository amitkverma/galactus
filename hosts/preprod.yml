all:
  vars:
    ansible_connection: ssh
    netdata_uuid: '4035023a-a53c-4053-93e0-f7b00f103490'
    netdata_master_ip: '178.128.72.107' # Netdata floating IP
    deny_default_user: 'ubuntu'
    prod_consul_datacenter: 'DO-BLR'
    prod_consul_domain: 'charcoaleats'
    consul_server_ip: '139.59.79.222' # Consul Private IP
    redis_password: 473d67d08db4314ef0366d2504e37e9f44168abe
    redis_deepstream_port: 6363
    redis_deepstream_server: '159.89.172.11'
    deepstream_websocket_port_lb: 443
    deepstream_websocket_ip_lb: 159.89.163.173
    deepstream_http_port: 8787
    deepstream_websocket_port: 5757
    pm2_user: root
    nodejs_application_port: 8888
    node_application_user: scylla
    deepstream_auth_url: https://preprod-api.charcoaleats.com/open/live/authenticateUser
    git_host: gitlab.charcoalbiryani.com
    nodejs_install_npm_user: root
    env_host_name: preprod.charcoaleats.com
    nodejs_cpo_port: 8001
    nodejs_api_port: 8888
    admin_user: driger
    users:
      - name: "driger" # Ansible User
        groups:
          - sudo
        keys:
          - "{{ lookup('file', '/Users/amitverma/Projects/side-projects/galactus/pub_keys/driger.pub') }}"
      - name: "dragoon" # Admin User 
        groups:
          - sudo
        keys:
          - "{{ lookup('file', '/Users/amitverma/Projects/side-projects/galactus/pub_keys/dragoon.pub') }}"
      - name: "scylla" # Deploy User
        groups:
          - www
        keys:
          - "{{ lookup('file', '/Users/amitverma/Projects/side-projects/galactus/pub_keys/scylla.pub') }}"


redis_msg_bus:
  hosts:
    159.89.172.11:
  vars:
    ansible_ssh_user: root
    server_name: 'preprod-redis-msg-bus'
    netdata_mode: 'slave'
    netdata_monitor_application: ['redis']
    consul_mode: 'client'
    firewall_open_ports: [8300,8301,19999,6363]
    nginx_custom_vhost: netdata
    redis_port: '{{ redis_deepstream_port }}'
    monitor_application_name: 'redis_msg_bus'
    health_check_script_enabled: true


deepstream_server:
  hosts:
    159.89.163.34:
        server_name: 'preprod-deepstream-node-1'
    159.89.163.37:
        server_name: 'preprod-deepstream-node-2'
  vars:
    ansible_ssh_user: driger
    netdata_mode: 'slave'
    netdata_monitor_application: []
    consul_mode: 'client'
    firewall_open_ports: [5757,8300,8301,19999,6363]
    is_redis_msg_plugin_used: true
    monitor_application_name: 'deepstream'
    deepstream_auth_enable: true
    health_check_script_enabled: true

deepstream_haproxy_lb:
  hosts:
    159.89.163.173:
  vars:
    ansible_ssh_user: root
    server_name: 'preprod-deepstream-loadbalancer'
    netdata_mode: 'slave'
    netdata_monitor_application: ['haproxy']
    consul_mode: 'client'
    firewall_open_ports: [443,8300,8301,19999,5757]
    haproxy_custom_vhost: deepstream
    deepstream_server:
      - name: 'deepstream_s1'
        host: '159.89.163.34'
      - name: 'deepstream_s2'
        host: ' 159.89.163.37'
    haproxy_ssl_enable: true
    monitor_application_name: 'haproxy'
    health_check_script_enabled: true


nodejs_server:
  hosts:
    159.89.167.79:
      server_name: 'application-server-1'
    159.89.171.196:
      server_name: 'application-server-2'
  vars:
    ansible_ssh_user: root
    netdata_mode: 'slave'
    netdata_monitor_application: ['nodejs']
    consul_mode: 'client'
    firewall_open_ports: [8888,8300,8301,19999]
    monitor_application_name: 'nodejs'
    health_check_script_enabled: true

api_haproxy_lb:
  hosts:
    159.89.167.2:
      server_name: 'lb-api-primary'
  vars:
    ansible_ssh_user: root
    netdata_mode: 'slave'
    netdata_monitor_application: ['haproxy']
    consul_mode: 'client'
    firewall_open_ports: [443,8300,8301,19999]
    haproxy_custom_vhost: api
    node_server:
      - name: 'node_s1'
        host: '159.89.167.79'
      - name: 'node_s2'
        host: '159.89.171.196'
    haproxy_ssl_enable: true
    monitor_application_name: 'haproxy'
    health_check_script_enabled: true

webserver_lb:
  hosts:
    139.59.21.115:
  vars:
    ansible_ssh_user: root
    server_name: 'webserver_lb'
    netdata_mode: 'slave'
    netdata_monitor_application: ['nginx']
    consul_mode: 'client'
    firewall_open_ports: [443,8300,8301,19999,5757]
    nginx_custom_vhost: charcoal-dev
    monitor_application_name: 'nginx'
    nginx_ssl_enable: true
    nodejs_server: 
      - name: 'preprod-application-server-1'
        host: '159.89.167.79'
      - name: 'preprod-application-server-2'
        host: '159.89.171.196'
    health_check_script_enabled: true